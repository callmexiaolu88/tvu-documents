<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="891px" height="431px" viewBox="-0.5 -0.5 891 431" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2021-02-07T03:11:24.895Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.7.9 Chrome/85.0.4183.121 Electron/10.1.3 Safari/537.36&quot; etag=&quot;x-Oji2cuqH7lNlpYs3TP&quot; version=&quot;13.7.9&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;-NQmv2yHCfsD4fJC1JSw&quot; name=&quot;Page-1&quot;&gt;7VlRb+I4EP41lujDoUCAJI9JCF2k9rS3XK/3ahIDuTp2LnEW6K+/seOQhoQtbemedIdUicl4PN/YM/48VpHpJ7vbDKebex4RioZGtEPmFA2HA3M4gR+p2Zca29CKdRZH2qhWLOJnopWG1hZxRPKGoeCcijhtKkPOGAlFQ4ezjG+bZitOm6gpXpOWYhFi2tY+xpHY6FWMjVr/hcTrTYU8MPRIgitjrcg3OOLbFyozQKafcS5KKdn5hMrNq/alnDc7MXoILCNMnDPhYTGdz8mfziSez1ZLK4kenpNfKjffMS30ilFgIc9F3kwKro1sDwUT5A2Qa0jBtpEzQQHoDWSPlQBmLgrGyLOkGQjSxlMaT7oCP46L7FG3Z3eG7JkSfOQO0iLfoGCEPAVQCq47FyR54WaCHPA0UVAGchwUzJDnI9tHwwmFzfCWGUhrKaHAQbaJvKny5UsPchFT5JSxBzJqjVeGDEOm8uxIs46QdRjBjoSFiDnzORNkJ9CwE96SEZexOobEk/AwX6/pEBQM+xKhI7pTgDrsckUOci05xx1070OXBicpCGyZy5+0WNI4lIUqsFDCEg4a/PxWkII85CR75NmTjLr3iGPhY0qXOHySZw9ET4kAbPDlX+ogzrQrctOBbZ0R0Fu/4xUg9upgDFnPsqQNVlDaFcUHAT9lFR/9/n0DpPeF0JRkfSW72bpIgCN+hU0IdiFJZQn1DlI13K827uasann7Xk3fU5Rv/Q5YXmRkzmIRYwqXSdQ7uZzL5630WDls84NB2qqyQI9t+z5OBSykET1Q+/KH8V94Rfogl+d7WR8pOGQnFnI4bPLb8uVfe9H9eT4lK1xQcSPN2mEr5uj1WrRTMY6Hc3LDyLaLmiobjaAhe02GKlnpFLr7cfQuvFI83oybn1WeQAUER1+B0W8pX2Ka97cQtFpBP2B/y99enWdftUpZSErjclNEVpCfFW5GoPyZBu1GsKa6rxL7qllTpWh6G5FAyNMBiEACawYyJSs58p1kcLVh6mp1EkeRnAx4efyMl8oRlLKX8pgJ1TqOPTSeSk+F4HnZnkrHq5hSn1OeKWTTdfxR4KlAj7uyqsMCaLJ7odJd2i3hCRHZHkz0qKUbRt0xj6pec1v3n5Oqy9y86D1NUyux7nnXB9d1WwiC7gzf0iW2msSynFoJyLdxQjGTO7qCAl/oEbmj4Sam0R3e80KGC0cifKq+vA3P4mewx1XaYDgT+jEAL4jmdjOuAOpJC+lMw6hEkq/V/g+OVPd41zC8w7moAuSU4jSPyyKQExOcrWPmcSF4oo0ukN6B2cyv2ZHfwaQjv5Z9Or0a7RsQNmZrWMEBbug04ew2mtUBVr3bKjBMBckY8JjHCxblrZI6rPP9VWa2nyJDr+NyPHXsc5HxJ3JUJR2F8wonCC4JKE9xGLP1nbKZjmrNN71HUsVh7oqqR90GmIQwWVcc2P4kk3iw1b7RH0tOAZYdw3vp8K1oJuWZvLVgLThWJUagQrckF53F98PT+npF7pu5fq0Aj2viYvwyOpH5xZ6F0MIyoOZr/j8v/+Phv5x/p5X/w5m/XjHvuGJGgzOumFFHhqtK+K9eMdW+tJjGzYFq7jjQwB9y6B6nSIZnDuqMXAnnteP7oQunqxw/jXCG7Y72zLvmSj9nPGCsM+jH+R92uMPxCfr5yvNrW/NaW3ORvrar7D6PZk49aRaEtR/P13x/MN9dfeyF8g2f9X/qSjqo/99pBv8A&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-64-31-152-26-0"><rect x="64" y="31" width="152" height="26"/></clipPath><clipPath id="mx-clip-64-57-152-26-0"><rect x="64" y="57" width="152" height="26"/></clipPath><clipPath id="mx-clip-344-31-132-26-0"><rect x="344" y="31" width="132" height="26"/></clipPath><clipPath id="mx-clip-704-31-182-26-0"><rect x="704" y="31" width="182" height="26"/></clipPath><clipPath id="mx-clip-704-57-182-26-0"><rect x="704" y="57" width="182" height="26"/></clipPath></defs><g><rect x="0" y="100" width="600" height="330" fill="#a9c4eb" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 265px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">线程池或者自己创建的线程每次push一个Item的时候，<br />都会捕获下当前线程的ExecutionContext,<br />然后把Item会在捕获的ExecutionContext上执行<br /><br /> public static bool QueueUserWorkItem(WaitCallback callBack, object? state)<br />{<br />    if (callBack == null)<br />    {<br />        ThrowHelper.ThrowArgumentNullException(ExceptionArgument.callBack);<br />    }<br /><br />    EnsureInitialized();<br /><br />    <b>ExecutionContext executionContext = ExecutionContext.Capture();</b><br /><br />    object callback = (executionContext == null || executionContext.IsDefault) <br />? ((QueueUserWorkItemCallbackBase)new QueueUserWorkItemCallbackDefaultContext(callBack, state)) <br />: ((QueueUserWorkItemCallbackBase)new QueueUserWorkItemCallback(callBack, state, executionContext));<br /><br />    ThreadPoolGlobals.workQueue.Enqueue(callback, forceGlobal: true);<br /><br />    return true;<br />}</div></div></div></foreignObject><text x="2" y="269" fill="#000000" font-family="Helvetica" font-size="12px">线程池或者自己创建的线程每次push一个Item的时候，...</text></switch></g><path d="M 60 26 L 60 0 L 220 0 L 220 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 60 26 L 60 78 L 220 78 L 220 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 60 26 L 220 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" text-anchor="middle" font-size="12px"><text x="139.5" y="17.5">Thread</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-64-31-152-26-0)" font-size="12px"><text x="65.5" y="43.5">+ ExecutionContext</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-64-57-152-26-0)" font-size="12px"><text x="65.5" y="69.5">+ SynchronizationContext</text></g><path d="M 340 26 L 340 0 L 480 0 L 480 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 340 26 L 340 52 L 480 52 L 480 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 340 26 L 480 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" text-anchor="middle" font-size="12px"><text x="409.5" y="17.5">Execution</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-344-31-132-26-0)" font-size="12px"><text x="345.5" y="43.5">+ AsyncLocalValueMap</text></g><path d="M 700 26 L 700 0 L 890 0 L 890 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 700 26 L 700 78 L 890 78 L 890 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 700 26 L 890 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" text-anchor="middle" font-size="12px"><text x="794.5" y="17.5">SynchronizationContext</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-704-31-182-26-0)" font-size="12px"><text x="705.5" y="43.5">+ Post</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-704-57-182-26-0)" font-size="12px"><text x="705.5" y="69.5">+ Send</text></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>